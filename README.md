TODO:
    - Refactor most of the code.
    - Switch to use Concepts
    - Finish ProgramOptionsWrapper